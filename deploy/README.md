# Formy éƒ¨ç½²é…ç½®ç›®å½•

æœ¬ç›®å½•åŒ…å« Formy åº”ç”¨çš„ Docker Compose éƒ¨ç½²é…ç½®æ–‡ä»¶ã€‚

## ğŸ“ æ–‡ä»¶è¯´æ˜

- **`docker-compose.aliyun.yml`** - ç”Ÿäº§ç¯å¢ƒ Docker Compose é…ç½®
  - åŒ…å« Backendã€Workerã€Redis ä¸‰ä¸ªæœåŠ¡
  - ä¼˜åŒ–ç”¨äºäº‘æœåŠ¡å™¨éƒ¨ç½²

- **`env.production.example`** - ç”Ÿäº§ç¯å¢ƒå˜é‡æ¨¡æ¿
  - å¤åˆ¶åˆ°é¡¹ç›®æ ¹ç›®å½•çš„ `.env` æ–‡ä»¶å¹¶å¡«å…¥å®é™…å€¼
  - åŒ…å«æ‰€æœ‰å¿…éœ€å’Œå¯é€‰çš„é…ç½®é¡¹

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å‡†å¤‡ç¯å¢ƒå˜é‡

```bash
# å¤åˆ¶ç¯å¢ƒå˜é‡æ¨¡æ¿åˆ°é¡¹ç›®æ ¹ç›®å½•
cp deploy/env.production.example ../.env

# ç¼–è¾‘ç¯å¢ƒå˜é‡æ–‡ä»¶
vim ../.env
```

### 2. å¯åŠ¨æœåŠ¡

```bash
# ä»é¡¹ç›®æ ¹ç›®å½•å¯åŠ¨
docker-compose -f deploy/docker-compose.aliyun.yml up -d

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose -f deploy/docker-compose.aliyun.yml ps

# æŸ¥çœ‹æ—¥å¿—
docker-compose -f deploy/docker-compose.aliyun.yml logs -f
```

### 3. éªŒè¯éƒ¨ç½²

```bash
# å¥åº·æ£€æŸ¥
curl http://localhost:8000/health

# è®¿é—® API æ–‡æ¡£
curl http://localhost:8000/docs
```

## ğŸ“– è¯¦ç»†æ–‡æ¡£

å®Œæ•´çš„éƒ¨ç½²æŒ‡å—è¯·å‚è€ƒ: [DEPLOY_ALIYUN_ECS.md](../DEPLOY_ALIYUN_ECS.md)

åŒ…å«:
- æœåŠ¡å™¨ç¯å¢ƒå‡†å¤‡
- è¯¦ç»†éƒ¨ç½²æ­¥éª¤
- é…ç½®è¯´æ˜
- æœåŠ¡ç®¡ç†å‘½ä»¤
- æ•…éšœæ’æŸ¥
- å‡çº§å’Œç»´æŠ¤

## ğŸ”§ æœåŠ¡æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Docker Network              â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ Backend  â”‚  â”‚  Worker  â”‚        â”‚
â”‚  â”‚  :8000   â”‚  â”‚          â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜        â”‚
â”‚       â”‚             â”‚              â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚              â”‚                     â”‚
â”‚         â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”               â”‚
â”‚         â”‚  Redis   â”‚               â”‚
â”‚         â”‚  :6379   â”‚               â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
   ComfyUI (å¤–éƒ¨)
```

## âš™ï¸ æœåŠ¡è¯´æ˜

### Backend
- FastAPI åº”ç”¨
- æä¾› REST API
- å¤„ç†ç”¨æˆ·è¯·æ±‚

### Worker
- å¼‚æ­¥ä»»åŠ¡å¤„ç†
- è°ƒç”¨ ComfyUI è¿›è¡Œ AI å¤„ç†
- æ›´æ–°ä»»åŠ¡çŠ¶æ€

### Redis
- ä»»åŠ¡é˜Ÿåˆ—
- ç¼“å­˜
- ç”¨æˆ·ä¼šè¯

## ğŸŒ ç«¯å£æ˜ å°„

- **8000** - Backend APIï¼ˆå®¿ä¸»æœº:å®¹å™¨ï¼‰
- **6379** - Redisï¼ˆå®¿ä¸»æœº:å®¹å™¨ï¼Œå¯é€‰æš´éœ²ï¼‰

## ğŸ“¦ æŒä¹…åŒ–å­˜å‚¨

ä½¿ç”¨ Docker Volumes æŒä¹…åŒ–æ•°æ®:

- `redis_data` - Redis æ•°æ®
- `uploads_data` - ç”¨æˆ·ä¸Šä¼ çš„å›¾ç‰‡
- `results_data` - AI å¤„ç†ç»“æœ

## ğŸ” å®‰å…¨å»ºè®®

1. âœ… è®¾ç½®å¼º Redis å¯†ç 
2. âœ… ä½¿ç”¨éšæœº JWT Secret Key
3. âœ… é…ç½®é˜²ç«å¢™è§„åˆ™
4. âœ… å¯ç”¨ HTTPS
5. âœ… å®šæœŸå¤‡ä»½æ•°æ®
6. âœ… å®šæœŸæ›´æ–°é•œåƒ

## ğŸ“ è·å–å¸®åŠ©

å¦‚é‡é—®é¢˜ï¼Œè¯·æŸ¥çœ‹:
- [é…ç½®æŒ‡å—](../backend/CONFIGURATION_GUIDE.md)
- [éƒ¨ç½²æ–‡æ¡£](../DEPLOY_ALIYUN_ECS.md)
- [GitHub Issues](https://github.com/wuyyybbb/formy_backend/issues)

